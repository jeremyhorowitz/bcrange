---
title: "bcrange2020.3"
author: "jeremy horowitz"
date: "February 27, 2020"
output: html_document
---

```{r}
library(tidyverse)
library(plotly)
library(cowplot)
library(sp)
library(quantreg)
```


plotting all lat on one plot for atl
```{r}

attach(atl_ranges3)
atl_subset<-subset(atl_ranges3,ocean=="atl")
atl_lat_all<-atl_subset[ atl_subset$type %in% c("lat_range","lat_planar_range","lat_geog_range"),]

#remove bounding points
atl_lat_all<-subset(atl_lat_all,!(species=="bound"))

#log the dependent variable:
#atl_lat_all<-atl_lat_all %>% mutate(area=log10(area))

write.csv(atl_lat_all,"output/atl_lat_all.csv")

attach(atl_lat_all)

atl_lat_all$type<-factor(atl_lat_all$type,levels=c("lat_range","lat_planar_range","lat_geog_range"))

lat_plot_atl<-ggplot(data=atl_lat_all,
       aes(mid,area,color=type))+geom_point()+
  geom_point(aes(y=area))+
  geom_smooth(se=F,method=loess,size=2)+
  theme_classic()+
  xlim(-80,80)+
  scale_y_continuous(trans='log10')+
  xlab("Mid-latitude (decimal degree)")+
  ylab("range extent m/m2")+
  geom_point(aes(x=-80, y=0), colour="black")+
  geom_point(aes(x=-40, y=1.445025e+14), colour="black")+
  geom_point(aes(x=-0, y=4.295588e+14), colour="black")+
  geom_point(aes(x=40, y=2.323491e+14), colour="black")+
  geom_point(aes(x=80, y=0), colour="black")+
  geom_point(aes(x=-40, y=2.890000e+14), colour="black")+
  geom_point(aes(x=-0, y=8.590000e+14), colour="black")+
  geom_point(aes(x=40, y=4.650000e+14), colour="black")+
  geom_point(aes(x=-40, y=1.518389e+07), colour="black")+
  geom_point(aes(x=0, y=3.036779e+07), colour="black")+
  geom_point(aes(x=40, y=1.518389e+07), colour="black")
  
lat_plot_atl

ggsave(filename="lat_plot_atl.tiff",path="figs/")



```
no species occur with mid-latitudes <-30 dec deg lat. the largest ranged species occur between -30 and 0 degrees lat, and then ranges decrease in area northerly. there is a dip in species range size at 30 deg lat. this can be explaained by the relatively large number of small-ranged, possibly endemic species occuring in the caribbean. there are also relatively large ranged species at this latitude but the caribbean species are greter in richness and therefore modify the trend. the trend does not change depending on the way ranges are considered, which means that latitude extent alone is sufficent to represent range area vs mid-lat relationships.

```{r}
attach(atl_ranges3)
pac_subset<-subset(atl_ranges3,ocean=="pac")
pac_lat_all<-pac_subset[pac_subset$type %in% c("lat_range","lat_planar_range","lat_geog_range"),]

#remove bounding points
pac_lat_all<-subset(pac_lat_all,!(species=="bound"))

#log the dependent variable:
#pac_lat_all<-atl_lat_all %>% mutate(area=log10(area))

write.csv(pac_lat_all,"output/pac_lat_all.csv")

attach(pac_lat_all)

pac_lat_all$type<-factor(pac_lat_all$type,levels=c("lat_range","lat_planar_range","lat_geog_range"))

lat_plot_pac<-ggplot(data=pac_lat_all,
       aes(mid,area,color=type))+geom_point()+
  geom_point(aes(y=area))+
  geom_smooth(se=F,method=loess,size=2)+
  theme_classic()+
  xlim(-80,80)+
  scale_y_continuous(trans='log10')+
  xlab("Mid-latitude (decimal degree)")+
  ylab("range extent m/m2")+
  geom_point(aes(x=-80, y=0), colour="black")+
  geom_point(aes(x=-45.000000, y=2.368199e+14), colour="black")+
  geom_point(aes(x=-10, y=4.185974e+14), colour="black")+
  geom_point(aes(x=30, y=1.603900e+14), colour="black")+
  geom_point(aes(x=70, y=0), colour="black")+
  geom_point(aes(x=-45, y=4.737704e+14), colour="black")+
  geom_point(aes(x=-10, y=8.372510e+14), colour="black")+
  geom_point(aes(x=30, y=3.208763e+14), colour="black")+
  geom_point(aes(x=70, y=0), colour="black")+
  geom_point(aes(x=-45, y=1.401611e+07), colour="black")+
  geom_point(aes(x=-00, y=2.605160e+07), colour="black")+
    geom_point(aes(x=30, y=1.192319e+07), colour="black")

  
lat_plot_pac

ggsave(filename="lat_plot_pac.tiff",path="figs/")
```

atl long all
```{r}

attach(atl_ranges3)
atl_subset<-subset(atl_ranges3,ocean=="atl")
atl_long_all<-atl_subset[ atl_subset$type %in% c("long_range","long_planar_range","long_geog_range"),]

#remove bounding points
atl_long_all<-subset(atl_long_all,!(species=="bound"))

#log the dependent variable:
#atl_long_all<-atl_long_all %>% mutate(area=log10(area))

write.csv(atl_long_all,"output/atl_long_all.csv")

attach(atl_long_all)

atl_long_all$type<-factor(atl_long_all$type,levels=c("long_range","long_planar_range","long_geog_range"))

long_plot_atl<-ggplot(data=atl_long_all,
       aes(mid,area,color=type))+geom_point()+
  geom_point(aes(y=area))+
  geom_smooth(se=F,method=loess,size=2)+
  theme_classic()+
  xlim(-110,45)+
  scale_y_continuous(trans='log10')+
  xlab("Mid-latitude (decimal degree)")+
  ylab("range extent m/m2")+
  geom_point(aes(x=-106, y=0), colour="black")+
  geom_point(aes(x=-68.375000, y=2.094712e+14), colour="black")+
  geom_point(aes(x=-30.750000, y=4.295588e+14), colour="black")+
  geom_point(aes(x=6.875000, y=2.159317e+14), colour="black")+
  geom_point(aes(x=44.5, y=0), colour="black")+
  geom_point(aes(x=-68.375000, y=4.190000e+14), colour="black")+
  geom_point(aes(x=-30.750000, y=8.590000e+14), colour="black")+
  geom_point(aes(x=6.875000, y=4.300000e+14), colour="black")+
  geom_point(aes(x=-68.375000, y=8.404622e+06), colour="black")+
  geom_point(aes(x=-30.750000, y=1.680924e+07), colour="black")+
  geom_point(aes(x=6.875000, y=8.404622e+06), colour="black")
  
long_plot_atl

ggsave(filename="long_plot_atl.tiff",path="figs/")

```
pac long
```{r}

attach(atl_ranges3)
pac_subset<-subset(atl_ranges3,ocean=="pac")
pac_long_all<-pac_subset[pac_subset$type %in% c("long_range","long_planar_range","long_geog_range"),]

#remove bounding points
pac_long_all<-subset(pac_long_all,!(species=="bound"))

#log the dependent variable:
#pac_long_all<-pac_long_all %>% mutate(area=log10(area))

write.csv(pac_long_all,"output/pac_long_all.csv")

attach(pac_long_all)

pac_long_all$type<-factor(pac_long_all$type,levels=c("long_range","long_planar_range","long_geog_range"))

long_plot_pac<-ggplot(data=pac_long_all,
       aes(mid_long_adjust,area,color=type))+geom_point()+
  geom_point(aes(y=area))+
  geom_smooth(se=F,method=loess,size=2)+
  theme_classic()+
  #xlim(-110,45)+
  scale_y_continuous(trans='log10')+
  xlab("Mid-latitude (decimal degree)")+
  ylab("range extent m/m2")

  geom_point(aes(x=-106, y=0), colour="black")+
  geom_point(aes(x=-68.375000, y=2.094712e+14), colour="black")+
  geom_point(aes(x=-30.750000, y=4.295588e+14), colour="black")+
  geom_point(aes(x=6.875000, y=2.159317e+14), colour="black")+
  geom_point(aes(x=44.5, y=0), colour="black")+
  geom_point(aes(x=-68.375000, y=4.190000e+14), colour="black")+
  geom_point(aes(x=-30.750000, y=8.590000e+14), colour="black")+
  geom_point(aes(x=6.875000, y=4.300000e+14), colour="black")+
  geom_point(aes(x=-68.375000, y=8.404622e+06), colour="black")+
  geom_point(aes(x=-30.750000, y=1.680924e+07), colour="black")+
  geom_point(aes(x=6.875000, y=8.404622e+06), colour="black")
  
long_plot_pac

ggsave(filename="long_plot_pac.tiff",path="figs/")
```



